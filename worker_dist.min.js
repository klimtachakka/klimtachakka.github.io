(()=>{var t={2234:function(t,n,e){var r,s,i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var s in n=arguments[e])Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);return t},i.apply(this,arguments)};r=[e,n,e(1328)],s=function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ModuleFormat=void 0,n.ModuleFormat=function(){return 34},(0,e.normal)();var r=[],s=[],a=[],o=3e3;self.onmessage=function(t){switch(t.data.workOrder){case 1001:switch(t.data.priority){case 4e3:a.push(t);break;case 4001:s.push(t);break;case 4002:r.push(t)}3e3===o&&h();break;case 1e3:s=[],a=[],r=[]}};var h=function(){o=3001;var t=[];if(a.length>0?t=a:s.length>0?t=s:r.length>0&&(t=r),0!==t.length){var n=t.shift(),e=t.length;try{u(n,e)}catch(t){self.postMessage({result:2001,guid:n.data.guid})}}else o=3e3},u=function(t,n){var e,r,s,a=performance.now(),o=t.data,u=o.items,f=o.inSystem,l=o.shipAngle,w=o.imPos,F=o.rw,D=o.rh,N=o.offset,O=o.start,W=o.end,j=o.itemRadius,_=(o.padding,o.scale),A=F,B=D,S=[2*j,j,0],U=0,q=0,z=0,C=0,E=Math.atan2(W.y-w.y,W.x-w.x);E>0?Math.PI:Math.PI,s=l>0?l<.5*Math.PI?l<.25*Math.PI?5:7:l>.75*Math.PI?1:6:l<-.5*Math.PI?l>-.75*Math.PI?2:0:l>-.25*Math.PI?4:3;for(var G=0;G<S.length;G++){var L=S[G];if(r=P(u,A,B,N.x,N.y,_,L,4,f),U=r[0].length-1,q=r.length-1,z=Math.min(U,Math.abs(O.x-N.x)*_|0),0===r[C=Math.min(q,Math.abs(O.y-N.y)*_|0)][z]){var R=Math.min(U,Math.abs(w.x-N.x)*_|0),T=Math.min(U,Math.abs(w.x-N.x)*_|0);1===r[T][R]&&(z=R,C=T)}if(1===r[C][z]){e=r;break}}e||(e=r);var H=f?[{withBackWalls:!0,closest:!1},{withBackWalls:!1,closest:!1}]:[{withBackWalls:!1,closest:!1}],J=[],K=Math.min(U,Math.abs(W.x-N.x)*_|0),Q=Math.min(q,Math.abs(W.y-N.y)*_|0);for(G=0;G<H.length;G++){var V=H[G],X=V.withBackWalls;switch(s){case 6:case 1:b(e,1,X),M(e,1,X);break;case 7:case 5:b(e,1,X),m(e,1,X);break;case 2:case 0:k(e,1,X),M(e,1,X);break;case 3:case 4:k(e,1,X),m(e,1,X)}e[C][z]=1;var Y=I(),Z=new Y.Graph(e,{diagonal:!0}),$=Z.grid[C][z],tt=Z.grid[Q][K];if((J=Y.astar.search(Z,$,tt,{closest:V.closest})).length>0)break}var nt=x(J);nt.filter((function(t){return t.x>1&&t.x<U-1&&t.y>1&&t.y<q-1})).length,nt.length;var et=1/_,rt=1e5,st=rt,it=x(J).map((function(t,n){var e=st===rt&&t.x>1&&t.x<U-1&&t.y>1&&t.y<q-1;return e||st!==rt||(st=n-1),{x:t.x,y:t.y,stable:e}}));st===rt&&(st=-1);var at=function(t,n){var e=n.length;if(e<=2)return{short:n,stepped:n};var r=[n[0]],s=[0];t:for(var a=0;a<e+1;a++)for(var o=n[a],h=a+1;h<e;h++){if(!(b=n[h]).stable){r.push(n[h-1]),s.push(h-1);break t}for(var u=p(o.x,o.y,b.x,b.y),f=!0,l=0;l<u.length;l+=2){var g=u[l];if(1!==t[u[l+1]][g]){f=!1;break}}if(!f){r.push(n[h-1]),s.push(h-1),a=h-1;break}if(h===e-1){r.push(n[n.length-1]),s.push(n.length-1),a=e;break}}var y=[];for(a=0;a<s.length-1;a++){var v=s[a],d=s[a+1],x=r[a],b=r[a+1],M=d-v;if(y.push(x),M>2){var m=M+2;for(h=1;h<m-1;h++){var k=c(x.x,x.y,b.x,b.y,h/m);y.push(i(i({},k),{stable:!0}))}}}return y.push(r[r.length-1]),{short:r,stepped:y}}(e,it),ot=at.short,ht=at.stepped,ut={guid:t.data.guid,result:2e3,lookingAt:s,corners:[y(0,et,N.x),y(0,et,N.y),U*et,q*et],graphMap:it.map((function(t,n){return{x:y(t.x,et,N.x),y:y(t.y,et,N.y),stable:t.stable}})),shortcut:ht.map((function(t,n){return{x:y(t.x,et,N.x),y:y(t.y,et,N.y),stable:t.stable}})),short:ot.map((function(t,n){return{x:y(t.x,et,N.x),y:y(t.y,et,N.y),stable:t.stable}})),shipAngleRadians:l,residualWork:n,start:v({x:z,y:C},et,N),end:v({x:K,y:Q},et,N),obstacles:d(g(e),et,N),time:"",stableIndex:st,bounds:{x:y(0,et,N.x),y:y(0,et,N.y),w:y(U+1,et,0),h:y(q+1,et,0)}},ct=performance.now()-a;ut.time=ct.toFixed(2),ut.stableIndex=st,self.postMessage(ut),setTimeout((function(){h()}),0)},c=function(t,n,e,r,s){return void 0===s&&(s=.5),{x:t+(e-t)*s,y:n+(r-n)*s}},f=Math.abs,l=Math.sign;function p(t,n,e,r){for(var s=f(e-t),i=f(r-n),a=l(e-t),o=l(r-n),h=s-i,u=[t,n];u.push(t,n),t!==e||n!==r;){var c=2*h;c>-i&&(h-=i,t+=a),c<s&&(h+=s,n+=o)}return u}!function(){function t(t,n){this.x=0,this.y=0,this.x=t,this.y=n}t.prototype.set=function(t,n){this.x=t,this.y=n},t.prototype.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.setLength=function(t){var n=this.getAngle();this.x=Math.cos(n)*t,this.y=Math.sin(n)*t},t.prototype.getAngle=function(){return Math.atan2(this.y,this.x)}}();var g=function(t){for(var n=[],e=0;e<t.length;e++)for(var r=0;r<t[e].length;r++)0===t[e][r]&&n.push(r,e);return n},y=function(t,n,e){return t*n+.5*n+e},v=function(t,n,e){return{x:t.x*n+.5*n+e.x,y:t.y*n+.5*n+e.y}},d=function(t,n,e){for(var r=0;r<t.length;r+=2){var s=t[r],i=t[r+1];s=s*n+.5*n+e.x,i=i*n+.5*n+e.y,t[r]=s,t[r+1]=i}return t},x=function(t){for(var n=[],e=t.length,r=0;r<e;r++)n.push({x:t[r].y,y:t[r].x});return n},b=function(t,n,e){for(var r=n;r<t[n].length-n;r++)t[n][r]=e?0:1},M=function(t,n,e){for(var r=t[0].length-(n+1),s=n;s<t.length-n;s++)t[s][r]=e?0:1},m=function(t,n,e){for(var r=n;r<t.length-n;r++)t[r][n]=e?0:1},k=function(t,n,e){for(var r=t.length-(n+1),s=n;s<t[n].length-n;s++)t[r][s]=e?0:1},w=function(t,n,e,r,s,i,a,o,h,u){if(!(e<1))for(var c,f,l=0,p=e,g=-e;l<=p;)c=t-p,f=p+p,y(t-l,n-p,n+p,l+l),y(c,n-l,n+l,f),(g+=l+++l)>=0&&(g-=--p+p);function y(t,n,e,r){r++;for(var s=0;r--;)v(s=t+r,n),v(s,e)}function v(t,n){t<s-u&&n<i-a&&t>=h&&n>=o&&(r[n][t]=0)}},P=function(t,n,e,r,s,i,a,o,h){for(var u=n*i|0,c=e*i|0,f=[],l=0;l<c;l++){for(var p=[],g=0;g<u;g++)p.push(1);f.push(p)}var y=0,v=0,d=0,x=0;switch(o){case 2:y=1,d=1,v=1;break;case 3:y=1,x=1,v=1;break;case 0:v=1,d=1,y=1;break;case 1:v=1,x=1,y=1;break;case 4:v=1,x=1,y=1,d=1}for(var b=0;b<t.length;b++){var M=t[b],m=(g=(M.pos.x-r)*i,l=(M.pos.y-s)*i,Math.max((M.radius+a)*i,h?2:1));w(0|g,0|l,0|m,f,u,c,y,v,d,x)}return f},F=Math.sqrt(2),I=function(){function t(t){for(var n=t,e=[];n.parent;)e.unshift(n),n=n.parent;return e}var n={search:function(e,r,s,i){e.cleanDirty();var a=(i=i||{}).heuristic||n.heuristics.manhattan,o=i.closest||!1,h=new D((function(t){return t.f})),u=r;for(r.h=a(r,s),e.markDirty(r),h.push(r);h.size()>0;){var c=h.pop();if(c===s)return t(c);c.closed=!0;for(var f=e.neighbors(c),l=0,p=f.length;l<p;++l){var g=f[l];if(!g.closed&&!g.isWall()){var y=c.g+g.getCost(c),v=g.visited;(!v||y<g.g)&&(g.visited=!0,g.parent=c,g.h=g.h||a(g,s),g.g=y,g.f=g.g+g.h,e.markDirty(g),o&&(g.h<u.h||g.h===u.h&&g.g<u.g)&&(u=g),v?h.rescoreElement(g):h.push(g))}}}return o?t(u):[]},heuristics:{manhattan:function(t,n){return Math.abs(n.x-t.x)+Math.abs(n.y-t.y)},diagonal:function(t,n){var e=F,r=Math.abs(n.x-t.x),s=Math.abs(n.y-t.y);return 1*(r+s)+(e-2)*Math.min(r,s)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};function e(t,n){n=n||{},this.nodes=[],this.diagonal=!!n.diagonal,this.grid=[];for(var e=0;e<t.length;e++){this.grid[e]=[];for(var s=0,i=t[e];s<i.length;s++){var a=new r(e,s,i[s]);this.grid[e][s]=a,this.nodes.push(a)}}this.init()}function r(t,n,e){this.x=t,this.y=n,this.weight=e}return e.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)n.cleanNode(this.nodes[t])},e.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)n.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},e.prototype.markDirty=function(t){this.dirtyNodes.push(t)},e.prototype.neighbors=function(t){var n=[],e=t.x,r=t.y,s=this.grid;return s[e-1]&&s[e-1][r]&&n.push(s[e-1][r]),s[e+1]&&s[e+1][r]&&n.push(s[e+1][r]),s[e]&&s[e][r-1]&&n.push(s[e][r-1]),s[e]&&s[e][r+1]&&n.push(s[e][r+1]),this.diagonal&&(s[e-1]&&s[e-1][r-1]&&n.push(s[e-1][r-1]),s[e+1]&&s[e+1][r-1]&&n.push(s[e+1][r-1]),s[e-1]&&s[e-1][r+1]&&n.push(s[e-1][r+1]),s[e+1]&&s[e+1][r+1]&&n.push(s[e+1][r+1])),n},e.prototype.toString=function(){for(var t=[],n=this.grid,e=0;e<n.length;e++){for(var r=[],s=n[e],i=0;i<s.length;i++)r.push(s[i].weight);t.push(r.join(" "))}return t.join("\n")},r.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},r.prototype.getCost=function(t){return t&&t.x!=this.x&&t.y!=this.y?1.41421*this.weight:this.weight},r.prototype.isWall=function(){return 0===this.weight},{astar:n,Graph:e}};function D(t){this.content=[],this.scoreFunction=t}D.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),t},remove:function(t){var n=this.content.indexOf(t),e=this.content.pop();n!==this.content.length-1&&(this.content[n]=e,this.scoreFunction(e)<this.scoreFunction(t)?this.sinkDown(n):this.bubbleUp(n))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var n=this.content[t];t>0;){var e=(t+1>>1)-1,r=this.content[e];if(!(this.scoreFunction(n)<this.scoreFunction(r)))break;this.content[e]=n,this.content[t]=r,t=e}},bubbleUp:function(t){for(var n=this.content.length,e=this.content[t],r=this.scoreFunction(e);;){var s,i=t+1<<1,a=i-1,o=null;if(a<n){var h=this.content[a];(s=this.scoreFunction(h))<r&&(o=a)}if(i<n){var u=this.content[i];this.scoreFunction(u)<(null===o?r:s)&&(o=i)}if(null===o)break;this.content[t]=this.content[o],this.content[o]=e,t=o}}}}.apply(n,r),void 0===s||(t.exports=s)},1328:(t,n,e)=>{var r;r=function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.normal=function(){return"normal;"},n.default=function(){return"auto;"}}.apply(n,[e,n]),void 0===r||(t.exports=r)}},n={};!function e(r){var s=n[r];if(void 0!==s)return s.exports;var i=n[r]={exports:{}};return t[r].call(i.exports,i,i.exports,e),i.exports}(2234)})();